var j=Object.defineProperty,$=Object.defineProperties;var L=Object.getOwnPropertyDescriptors;var S=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var T=(d,e,r)=>e in d?j(d,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):d[e]=r,E=(d,e)=>{for(var r in e||(e={}))M.call(e,r)&&T(d,r,e[r]);if(S)for(var r of S(e))q.call(e,r)&&T(d,r,e[r]);return d},N=(d,e)=>$(d,L(e));var u=(d,e,r)=>new Promise((a,s)=>{var c=o=>{try{i(r.next(o))}catch(n){s(n)}},l=o=>{try{i(r.throw(o))}catch(n){s(n)}},i=o=>o.done?a(o.value):Promise.resolve(o.value).then(c,l);i((r=r.apply(d,e)).next())});const z="https://app.dataengineerhub.blog",O="".concat(z,"/wp-json/wp/v2");class B{constructor(){this.baseURL=O,this.cache=new Map,this.cacheTimeout=10*1e3,this.requestQueue=new Map}clearCache(e=null){if(e)for(const[r]of this.cache.entries())r.includes(e)&&this.cache.delete(r);else this.cache.clear()}makeRequest(a){return u(this,arguments,function*(e,r={}){const s="".concat(e,"_").concat(JSON.stringify(r)),c=this.cache.get(s);if(c&&Date.now()-c.timestamp<this.cacheTimeout)return c.data;try{const l=new AbortController,i=setTimeout(()=>l.abort(),15e3),o=yield fetch("".concat(this.baseURL).concat(e),E({mode:"cors",headers:E({"Content-Type":"application/json",Accept:"application/json","Cache-Control":"no-cache"},r.headers),signal:l.signal},r));if(clearTimeout(i),!o.ok){const p=yield o.text().catch(()=>"Unknown error");throw o.status===404?new Error("Content not found"):o.status>=500?new Error("Server error - please try again later"):new Error("Request failed (".concat(o.status,")"))}let n;try{n=yield o.json()}catch(p){throw new Error("Invalid response format from server")}if(n==null)throw new Error("No data received from server");const m=parseInt(o.headers.get("X-WP-Total")||"0"),h=parseInt(o.headers.get("X-WP-TotalPages")||"1"),f={data:n,totalPosts:m,totalPages:h,timestamp:Date.now()};return this.cache.set(s,f),f}catch(l){throw l.name==="AbortError"?new Error("Request timed out - please check your connection"):l.message.includes("fetch")?new Error("Network error - please check your internet connection"):l}})}getPosts(){return u(this,arguments,function*({page:e=1,per_page:r=10,categoryId:a=null,search:s=null,featured:c=null,trending:l=null}={}){try{const i=new URLSearchParams({page:Math.max(1,e).toString(),per_page:Math.min(100,Math.max(1,r)).toString(),_embed:"true",status:"publish"});a&&!isNaN(a)&&i.append("categories",a.toString()),s&&s.trim()&&i.append("search",s.trim()),c&&(i.append("meta_key","featured"),i.append("meta_value","1")),l&&(i.append("meta_key","trending"),i.append("meta_value","1"));const o=yield this.makeRequest("/posts?".concat(i.toString()));if(!o||typeof o!="object")return{posts:[],totalPages:1,totalPosts:0};const n=o.data;return Array.isArray(n)?{posts:this.transformPosts(n),totalPages:o.totalPages||1,totalPosts:o.totalPosts||0}:n&&typeof n=="object"&&Array.isArray(n.posts)?{posts:this.transformPosts(n.posts),totalPages:n.totalPages||1,totalPosts:n.totalPosts||0}:{posts:[],totalPages:1,totalPosts:0}}catch(i){throw i}})}getCategories(){return u(this,null,function*(){try{const r=(yield this.makeRequest("/categories?per_page=100&hide_empty=false")).data;return Array.isArray(r)?r.map(a=>({id:a.id||0,name:a.name||"Unnamed Category",slug:a.slug||"",count:a.count||0,description:a.description||""})):[]}catch(e){return[]}})}getCategoryIdBySlug(e){return u(this,null,function*(){try{if(!e||typeof e!="string")throw new Error("Invalid category slug provided");const a=(yield this.getCategories()).find(s=>s.slug.toLowerCase()===e.toLowerCase()||s.name.toLowerCase()===e.toLowerCase());if(a)return a.id;throw new Error('Category "'.concat(e,'" not found'))}catch(r){throw r}})}getPostsByCategory(a){return u(this,arguments,function*(e,r={}){return this.getPosts(N(E({},r),{categoryId:e}))})}getPostBySlug(e){return u(this,null,function*(){try{if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid post slug provided");const r=e.trim(),s=(yield this.makeRequest("/posts?slug=".concat(encodeURIComponent(r),"&_embed=true&status=publish"))).data;if(!Array.isArray(s))throw new Error("Invalid response from server");if(s.length===0)throw new Error('Post with slug "'.concat(r,'" not found'));return this.transformPost(s[0])}catch(r){throw r}})}transformPost(e){var r,a,s,c,l,i,o,n,m,h,f,p,b,A,x,C,w;try{if(!e||typeof e!="object")throw new Error("Invalid post data provided");let g="https://images.unsplash.com/photo-1595872018818-97555653a011?w=800&h=600&fit=crop";try{const t=(a=(r=e._embedded)==null?void 0:r["wp:featuredmedia"])==null?void 0:a[0];t&&t.source_url?(l=(c=(s=t.media_details)==null?void 0:s.sizes)==null?void 0:c.large)!=null&&l.source_url?g=t.media_details.sizes.large.source_url:(n=(o=(i=t.media_details)==null?void 0:i.sizes)==null?void 0:o.medium_large)!=null&&n.source_url?g=t.media_details.sizes.medium_large.source_url:g=t.source_url:e.jetpack_featured_media_url?g=e.jetpack_featured_media_url:e.featured_media_src_url&&(g=e.featured_media_src_url)}catch(t){}let k="Uncategorized";try{const t=((h=(m=e._embedded)==null?void 0:m["wp:term"])==null?void 0:h[0])||[];if(Array.isArray(t)&&t.length>0){const _=t.find(U=>U.name!=="Uncategorized");k=(_==null?void 0:_.name)||((f=t[0])==null?void 0:f.name)||"Uncategorized"}}catch(t){}let I="DataEngineer Hub";try{const t=(b=(p=e._embedded)==null?void 0:p.author)==null?void 0:b[0];t&&t.name&&(I=t.name)}catch(t){}let R=!1,v=!1;try{e.meta&&typeof e.meta=="object"&&(R=e.meta.featured==="1"||e.meta.featured===1||e.meta.featured===!0,v=e.meta.trending==="1"||e.meta.trending===1||e.meta.trending===!0)}catch(t){}let D="";try{e.excerpt&&e.excerpt.rendered&&(D=this.cleanExcerpt(e.excerpt.rendered))}catch(t){}let y=new Date().toISOString();try{if(e.date&&e.date!=="0000-00-00 00:00:00"){const t=new Date(e.date);isNaN(t.getTime())||(y=e.date)}else if(e.date_gmt&&e.date_gmt!=="0000-00-00 00:00:00"){const t=new Date(e.date_gmt);isNaN(t.getTime())||(y=e.date_gmt)}else if(e.modified&&e.modified!=="0000-00-00 00:00:00"){const t=new Date(e.modified);isNaN(t.getTime())||(y=e.modified)}}catch(t){}return{id:e.id||Math.random(),slug:e.slug||"",title:((A=e.title)==null?void 0:A.rendered)||e.title||"Untitled",excerpt:D,content:((x=e.content)==null?void 0:x.rendered)||e.content||"",category:k,readTime:this.calculateReadTime(((C=e.content)==null?void 0:C.rendered)||e.content||""),date:y,image:g,featured:R,trending:v,author:I}}catch(g){return{id:(e==null?void 0:e.id)||Math.random(),slug:(e==null?void 0:e.slug)||"",title:((w=e==null?void 0:e.title)==null?void 0:w.rendered)||(e==null?void 0:e.title)||"Error Loading Post",excerpt:"There was an error loading this post content.",content:"<p>There was an error loading this post content. Please try refreshing the page.</p>",category:"Uncategorized",readTime:"1 min read",date:new Date().toISOString(),image:"https://images.unsplash.com/photo-1595872018818-97555653a011?w=800&h=600&fit=crop",featured:!1,trending:!1,author:"DataEngineer Hub"}}}transformPosts(e){return Array.isArray(e)?e.map(r=>{try{return this.transformPost(r)}catch(a){return null}}).filter(r=>r!==null):[]}cleanExcerpt(e){try{return e.replace(/<[^>]*>/g,"").replace(/\[&hellip;\]/g,"...").replace(/&[^;]+;/g,"").trim()}catch(r){return""}}calculateReadTime(e){try{if(!e)return"1 min read";const r=200,a=e.replace(/<[^>]*>/g,"").trim();if(a.length===0)return"1 min read";const s=a.split(/\s+/).length,c=Math.max(1,Math.ceil(s/r));return"".concat(c," min read")}catch(r){return"1 min read"}}healthCheck(){return u(this,null,function*(){try{const e=yield this.makeRequest("/posts?per_page=1");return!0}catch(e){return!1}})}subscribeNewsletter(e){return u(this,null,function*(){return{success:!0}})}submitContactForm(e){return u(this,null,function*(){return{success:!0}})}}const H=new B;export{H as w};
