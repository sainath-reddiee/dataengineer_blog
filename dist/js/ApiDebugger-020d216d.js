import{j as e}from"../assets/index-4f828209.js";import{r as p}from"./chunk-966c10cc.js";import{w as i}from"./chunk-4a921aab.js";import{B as x}from"./chunk-cea607c5.js";import{p as j,A as N,s as C,t as _}from"./chunk-84f5b8d2.js";var S=Object.defineProperty,A=Object.defineProperties,I=Object.getOwnPropertyDescriptors,y=Object.getOwnPropertySymbols,O=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable,P=(a,r,n)=>r in a?S(a,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[r]=n,w=(a,r)=>{for(var n in r||(r={}))O.call(r,n)&&P(a,n,r[n]);if(y)for(var n of y(r))D.call(r,n)&&P(a,n,r[n]);return a},v=(a,r)=>A(a,I(r)),m=(a,r,n)=>new Promise((c,d)=>{var u=s=>{try{h(n.next(s))}catch(t){d(t)}},g=s=>{try{h(n.throw(s))}catch(t){d(t)}},h=s=>s.done?c(s.value):Promise.resolve(s.value).then(u,g);h((n=n.apply(a,r)).next())});const E=()=>{const[a,r]=p.useState({}),[n,c]=p.useState(!1),d=(s,t)=>m(void 0,null,function*(){r(l=>v(w({},l),{[s]:{status:"running",result:null,error:null,duration:0}}));const o=Date.now();try{const l=yield t(),b=Date.now()-o;r(f=>v(w({},f),{[s]:{status:"success",result:l,error:null,duration:b}}))}catch(l){const b=Date.now()-o;r(f=>v(w({},f),{[s]:{status:"error",result:null,error:l.message,duration:b}}))}}),u=()=>m(void 0,null,function*(){c(!0),r({});const s=[{name:"API Health Check",fn:()=>i.healthCheck()},{name:"Fetch Categories",fn:()=>m(void 0,null,function*(){const t=yield i.getCategories();return{count:t.length,categories:t.slice(0,3)}})},{name:"Fetch Recent Posts",fn:()=>m(void 0,null,function*(){const t=yield i.getPosts({per_page:3});return{count:t.posts.length,totalPosts:t.totalPosts,posts:t.posts.map(o=>({id:o.id,title:o.title,slug:o.slug}))}})},{name:"Fetch Single Post",fn:()=>m(void 0,null,function*(){const t=yield i.getPosts({per_page:1});if(t.posts.length===0)throw new Error("No posts available to test with");const o=t.posts[0].slug,l=yield i.getPostBySlug(o);return{slug:o,title:l.title,hasContent:!!l.content}})},{name:"Test Category Filter",fn:()=>m(void 0,null,function*(){const t=yield i.getCategories();if(t.length===0)throw new Error("No categories available to test with");const o=t[0],l=yield i.getPostsByCategory(o.id,{per_page:2});return{categoryName:o.name,postsFound:l.posts.length,totalPosts:l.totalPosts}})}];for(const t of s)yield d(t.name,t.fn),yield new Promise(o=>setTimeout(o,500));c(!1)}),g=s=>{switch(s){case"running":return e.jsx(j,{className:"h-5 w-5 animate-spin text-blue-400"});case"success":return e.jsx(_,{className:"h-5 w-5 text-green-400"});case"error":return e.jsx(C,{className:"h-5 w-5 text-red-400"});default:return e.jsx(N,{className:"h-5 w-5 text-gray-400"})}},h=s=>{switch(s){case"success":return"border-green-400/50 bg-green-500/10";case"error":return"border-red-400/50 bg-red-500/10";case"running":return"border-blue-400/50 bg-blue-500/10";default:return"border-gray-400/50 bg-gray-500/10"}};return p.useEffect(()=>{},[]),e.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"WordPress API Debugger"}),e.jsx("p",{className:"text-gray-400",children:"Test your WordPress API connection and data retrieval"})]}),e.jsx("div",{className:"mb-6",children:e.jsx(x,{onClick:u,disabled:n,className:"bg-blue-600 hover:bg-blue-700 text-white",children:n?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"mr-2 h-4 w-4 animate-spin"}),"Running Tests..."]}):"Run All Tests"})}),e.jsx("div",{className:"space-y-4",children:Object.entries(a).map(([s,t])=>e.jsxs("div",{className:"border-2 rounded-lg p-4 ".concat(h(t.status)),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[g(t.status),e.jsx("h3",{className:"font-semibold text-white",children:s})]}),e.jsx("div",{className:"text-sm text-gray-400",children:t.duration>0&&"".concat(t.duration,"ms")})]}),t.error&&e.jsxs("div",{className:"mt-3 p-3 bg-red-900/30 border border-red-700/50 rounded",children:[e.jsx("p",{className:"text-red-300 font-medium",children:"Error:"}),e.jsx("p",{className:"text-red-200 text-sm",children:t.error})]}),t.result&&e.jsxs("div",{className:"mt-3 p-3 bg-green-900/30 border border-green-700/50 rounded",children:[e.jsx("p",{className:"text-green-300 font-medium mb-2",children:"Result:"}),e.jsx("pre",{className:"text-green-200 text-sm overflow-auto",children:JSON.stringify(t.result,null,2)})]})]},s))}),e.jsxs("div",{className:"mt-8 p-4 bg-gray-900/50 border border-gray-700 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-white mb-2",children:"Configuration"}),e.jsxs("div",{className:"text-sm text-gray-300 space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"API URL:"})," https://app.dataengineerhub.blog/wp-json/wp/v2"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Cache Timeout:"})," 10 seconds"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Environment:"})," ","Production"]})]})]}),e.jsxs("div",{className:"mt-6 flex flex-wrap gap-3",children:[e.jsx(x,{variant:"outline",onClick:()=>i.clearCache(),className:"border-yellow-400/50 text-yellow-300 hover:bg-yellow-500/20",children:"Clear API Cache"}),e.jsx(x,{variant:"outline",onClick:()=>{},className:"border-purple-400/50 text-purple-300 hover:bg-purple-500/20",children:"Log API Instance"}),e.jsx(x,{variant:"outline",onClick:()=>{JSON.stringify({tests:a,timestamp:new Date().toISOString(),userAgent:navigator.userAgent},null,2)},className:"border-indigo-400/50 text-indigo-300 hover:bg-indigo-500/20",children:"Export Debug Report"})]})]})},B=()=>{const[a,r]=p.useState(!1);return p.useEffect(()=>{const c=new URLSearchParams(window.location.search).has("debug"),d=localStorage.getItem("api-debug")==="true";(c||d)&&(r(!0),c&&localStorage.setItem("api-debug","true")),window.debugAPI={clearCache:()=>i.clearCache(),testConnection:()=>i.healthCheck(),getApiInstance:()=>i,toggleDebug:()=>{const u=!a;if(r(u),localStorage.setItem("api-debug",u.toString()),!u){const g=new URL(window.location);g.searchParams.delete("debug"),window.history.replaceState({},"",g)}}}},[a]),{debugMode:a,ApiDebugger:E}};export{E as default,B as useApiDebugger};
